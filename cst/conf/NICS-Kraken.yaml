# NICS Kraken: Cray XT5
python: /lustre/scratch/gely/local/bin/python
account: TG-MCA03S012
maxnodes: 8192
maxcores: 12
maxram: 16384
maxtime: 1440
rate: 1000000

# MPI
ppn_range: []
nthread: 1
launch: aprun -n {nproc} {command}

# MPI + OpenMP
ppn_range: [1]
nthread: 12
launch: OMP_NUM_THREAD={nthread} aprun -d {nthread} -n {nproc} {command}\n

script: |
    #!/bin/bash
    #PBS -A {account}
    #PBS -N {name}
    #PBS -M {email}
    #PBS -l size={totalcores}
    #PBS -l walltime={walltime}
    #PBS -e {name}.err
    #PBS -o {name}.out
    #PBS -m n
    cd "$PBS_O_WORKDIR"
    env > "{name}.env"
    lfs setstripe -c 1 .
    [ {nstripe} -ge -1 -a -d {iodir} ] && lfs setstripe -c {nstripe} {iodir}
    date
    {pre}
    {launch}
    {post}
    date
