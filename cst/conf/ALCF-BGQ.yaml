# ALCF IBM Blue Gene/Q
account: GroundMotion_esp
maxcores: 16
maxram: 16384
host_opts: {
    vesta: {maxnodes: 1024,  maxtime: 120},
    cetus: {maxnodes: 1024,  maxtime: 120},
    mira:  {maxnodes: 49152, maxtime: 720},
}

# MPI
ppn_range: [1, 2, 4, 8, 16, 32]
nthread: 1
launch:
    runjob --verbose=INFO --block $COBALT_PARTNAME
    ${{COBALT_CORNER:+--corner}} $COBALT_CORNER
    ${{COBALT_SHAPE:+--shape}} $COBALT_SHAPE
    --envs BG_SHAREDMEMSIZE=32MB PAMID_VERBOSE=1
        VPROF_PROFILE=yes\n
    -n {nproc} -p {ppn} --exe {command}

# MPI + OpenMP
ppn_range: [1]
nthread: 32
launch:
    runjob --verbose=INFO --block $COBALT_PARTNAME
    ${{COBALT_CORNER:+--corner}} $COBALT_CORNER
    ${{COBALT_SHAPE:+--shape}} $COBALT_SHAPE
    --envs BG_SHAREDMEMSIZE=32MB PAMID_VERBOSE=1
        VPROF_PROFILE=yes OMP_NUM_THREADS={nthread}\n
    -n {nproc} -p {ppn} --exe {command}

# job submission
notify: -M {email}
submit:
    qsub --mode script
    --env BG_SHAREDMEMSIZE=32MB:PAMID_VERBOSE=1:VPROF_PROFILE=yes
    -O {name} -A {account} -n {nodes} -t {minutes}
    {notify} {submit_flags} "{name}.sh"
submit2:
    qsub --mode script
    --env BG_SHAREDMEMSIZE=32MB:PAMID_VERBOSE=1:VPROF_PROFILE=yes
    -O {name} -A {account} -n {nodes} -t {minutes}
    --dependenices {depend}
    {notify} {submit_flags} "{name}.sh"
