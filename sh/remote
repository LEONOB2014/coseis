#!/bin/bash -e

accounts="\
  phim.ucsd.edu
  kim
  moho.sdsu.edu
  altai.sdsu.edu
  ux451302@dslogin.sdsc.edu
  ux451302@tg-login2.sdsc.teragrid.org
  babieca.sdsu.edu"

files="\
  versionmeta.m
  email
  doc
  sord
  in.m
  in
  sh
  f
  m
  util
  scecvm4
  data"

echo "SORD remote install"

list="1"
if [ -n "$1" ]; then
  list="$*"
else
  echo "$accounts" | cat -b
  echo -n "hosts [$list]: "
  read i
  [ -n "$i" ] && list="$i"
fi

rfiles=$( echo "$files" | sed '/^$/d; s|^ *|sord/|g' )
files=$( echo $files )
rfiles=$( echo $rfiles )
accounts=( $accounts )

for i in $list; do
  account=${accounts[i-1]}
  echo $account
  rsync -av --delete --exclude='srcdir.m' --exclude='versionmeta.m' $files $account:sord
done

