#!/bin/bash -e

list="1 2 3 4 5"

accounts="\
  phim.ucsd.edu
  babieca.sdsu.edu
  ux451302@tg-login2.sdsc.teragrid.org
  ux451302@dslogin.sdsc.edu
  altai.sdsu.edu
  moho.sdsu.edu"

files="\
  readme
  sord
  defaults.m
  in.m
  in
  sh
  f
  terashake
  ts
  data
  m"

echo "SORD remote install"

rfiles=$( echo "$files" | sed '/^$/d; s|^ *|sord/|g' )
files=$( echo $files )
rfiles=$( echo $rfiles )

ssh-add -L > /dev/null || ssh-add

echo "$accounts" | cat -b
echo -n "hosts [$list]: "
read i
[ -n "$i" ] && list="$i"

for i in $list; do
  account=$( echo "$accounts" | sed -n ${i}p )
  echo $account
  rsync -av --delete --exclude='srcdir.m' $files $account:sord
done

