#!/usr/bin/env python
"""
Convert binary files to Numpy
"""
import sys, json
import numpy as np

meta = json.load(open('meta.json'))
dtype = meta['dtype']

for f in sys.argv[1:]:
    f1 = f.replace('.bin', '.npy')
    if f == f1:
        sys.exit('Missing .bin extention')
    if 'shapes' in meta and f in meta['shapes']:
        print(f)
        n = meta['shapes'][f]
        v = np.fromfile(f, dtype).reshape(n[::-1]).T
    elif 'shape' in meta:
        print(f)
        n = meta['shape']
        v = np.fromfile(f, dtype).reshape(n[::-1]).T
    else:
        print('Warning: no shape information found for ' + f)
        v = np.fromfile(f, dtype)
    np.save(f1, v)

